# Milestone v1.0: Android Test Harness

**Status:** ✅ SHIPPED 2026-01-19
**Phases:** 1-6
**Total Plans:** 11

## Overview

Transform the SleepIQ-specific test harness into a general-purpose Android security testing environment. Starting with security hardening and configuration cleanup, then generalizing the codebase, adding proxy integration, APK analysis tooling, and finally extending Frida scripts for comprehensive bypass capabilities.

## Phases

### Phase 1: Configuration & Security

**Goal**: Eliminate hardcoded credentials and insecure temp file storage; establish proper configuration management
**Depends on**: Nothing (first phase)
**Plans**: 2 plans

Plans:
- [x] 01-01: Environment variable configuration system
- [x] 01-02: Secure credential handling and temp file cleanup

**Key Changes:**
- Created config.py with python-dotenv for environment-based configuration
- Secure temp file handling with 0o600 permissions and atexit cleanup
- Created .env.example template

### Phase 2: Generalization

**Goal**: Remove all SleepIQ-specific code and make the harness work with any Android app
**Depends on**: Phase 1
**Plans**: 2 plans

Plans:
- [x] 02-01: Generalize Python harness (rename class, configurable package, optional auth)
- [x] 02-02: Generalize shell scripts and documentation

**Key Changes:**
- Renamed SleepIQTestHarness → AndroidTestHarness
- Made credentials optional, added TARGET_PACKAGE support
- Created install-app.sh replacing install-sleepiq.sh
- Renamed AVD to Android_Test_Device

### Phase 3: Proxy Integration

**Goal**: Configure Android emulator to route all traffic through Burp Suite CE for interception
**Depends on**: Phase 2
**Plans**: 2 plans

Plans:
- [x] 03-01: Emulator proxy configuration and CA certificate setup
- [x] 03-02: Documentation and verification

**Key Changes:**
- Created configure-proxy.sh for ADB proxy settings
- Created install-burp-cert.sh for CA certificate installation
- Created start-emulator-proxy.sh for one-command proxy startup
- Added BURP_PROXY environment variable support

### Phase 4: APK Analysis Tooling

**Goal**: Integrate jadx and apktool for APK decompilation and analysis
**Depends on**: Phase 1 (uses config system)
**Plans**: 2 plans

Plans:
- [x] 04-01: jadx integration for Java source decompilation
- [x] 04-02: apktool integration for resource extraction

**Key Changes:**
- Created decompile-apk.sh for jadx decompilation
- Created decode-apk.sh for apktool resource extraction
- Auto-selects most recent APK from apks/ directory
- Output structure: decompiled/<app>/<tool>/

### Phase 5: Code Browsing Workflow

**Goal**: Create workflow for navigating and examining decompiled APK code
**Depends on**: Phase 4
**Plans**: 1 plan

Plans:
- [x] 05-01: Code browsing scripts and output organization

**Key Changes:**
- Created analyze-apk.sh unified analysis combining jadx + apktool + security scan
- Created search-code.sh with preset patterns (secrets, network, crypto, storage, auth)
- Permissions highlighting, exported components, hardcoded secrets detection

### Phase 6: Security Bypasses

**Goal**: Extend Frida scripts to bypass root detection and emulator detection
**Depends on**: Phase 2 (harness must be generalized first)
**Plans**: 2 plans

Plans:
- [x] 06-01: Root detection bypass Frida script
- [x] 06-02: Emulator detection bypass Frida script

**Key Changes:**
- Created frida_root_bypass.js with 9 hook categories (File.exists, Runtime.exec, Build.TAGS, etc.)
- Created frida_emulator_bypass.js with Build field spoofing, TelephonyManager hooks
- Native libc hooks for low-level detection methods
- RootBeer library bypass support

---

## Milestone Summary

**Key Decisions:**
- Use python-dotenv for .env loading
- Use dataclass for typed configuration
- Dual tooling approach - jadx for Java source, apktool for manifest/resources
- Comprehensive hook coverage - both Java and native hooks
- Fake device profile (Pixel 6 Pro) for emulator bypass

**Issues Resolved:**
- Hardcoded credentials removed
- SleepIQ-specific code generalized
- Insecure temp file handling fixed

**Issues Deferred:**
- None

**Technical Debt Incurred:**
- None

---

_For current project status, see .planning/ROADMAP.md_
