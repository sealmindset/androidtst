# Plan: 06-02 Emulator Detection Bypass

## Context

**Phase**: 6 - Security Bypasses
**Goal**: Create a Frida script that bypasses common emulator detection mechanisms
**Dependencies**: Plan 06-01 (establishes bypass script patterns)
**Patterns**: Follow existing Frida script structure

## Background

Emulator detection prevents apps from running in virtualized environments. Apps typically check:

1. **Build properties** - FINGERPRINT, MODEL, MANUFACTURER, BRAND, DEVICE, PRODUCT, HARDWARE
2. **IMEI/Device IDs** - Emulators return predictable values (000000000000000)
3. **Phone number** - Emulators have test numbers like 15555215554
4. **Sensors** - Missing or limited sensors in emulators
5. **Files** - /system/lib/libc_malloc_debug_qemu.so, /dev/qemu_pipe
6. **System properties** - ro.kernel.qemu, ro.hardware, init.goldfish.rc
7. **Network** - Specific emulator IP ranges (10.0.2.x)
8. **CPU info** - Goldfish or ranchu in /proc/cpuinfo

## Tasks

### Task 1: Create frida_emulator_bypass.js

Create the emulator detection bypass Frida script.

**File**: `frida_emulator_bypass.js`

**Hooks to implement**:
1. **Build class fields** - Return realistic device values:
   - FINGERPRINT: Remove "generic", "sdk", "google_sdk"
   - MODEL: Return real device model
   - MANUFACTURER: Return real manufacturer
   - BRAND, DEVICE, PRODUCT, HARDWARE: Return realistic values
2. **TelephonyManager** - Return realistic phone values:
   - getDeviceId(): Return fake IMEI
   - getLine1Number(): Return fake phone number
   - getNetworkOperatorName(): Return carrier name
3. **File.exists()** - Hide emulator-specific files:
   - /dev/qemu_pipe, /dev/goldfish_pipe
   - /system/lib/libc_malloc_debug_qemu.so
   - /sys/qemu_trace, /system/bin/qemu-props
4. **System.getProperty()** - Hide emulator properties:
   - ro.kernel.qemu → null
   - ro.hardware → realistic value
   - ro.product.model → realistic value

**Structure**:
```javascript
Java.perform(function() {
    console.log("[*] Starting Emulator Detection Bypass...");

    // Modify Build class fields
    // Hook TelephonyManager methods
    // Hook File.exists() for emulator files
    // Hook System.getProperty() for emulator properties

    console.log("[*] Emulator Detection Bypass Complete!");
});
```

**Verification**:
- Script has valid JavaScript syntax
- All hooks wrapped in try-catch
- Logging follows existing pattern

**Commit**: "feat: add emulator detection bypass Frida script"

### Task 2: Update README with emulator bypass documentation

Add documentation for using the emulator bypass script.

**File**: `README.md`

**Changes**:
- Add emulator bypass to Security Bypasses section
- Document frida_emulator_bypass.js usage
- Add combined usage example (root + emulator + SSL)
- Update Scripts Overview table

**Verification**:
- Emulator bypass documented
- Combined usage example included
- Scripts table includes all bypass scripts

**Commit**: "docs: add emulator detection bypass documentation"

### Task 3: Verify scripts and commit metadata

**Verification checklist**:
- [ ] frida_emulator_bypass.js exists and follows project patterns
- [ ] README.md includes all bypass scripts
- [ ] Security Bypasses section is complete

**Metadata**:
- Create 06-02-SUMMARY.md
- Update STATE.md to mark Phase 6 complete
- Update ROADMAP.md to mark 06-02 and Phase 6 complete

**Commit**: "chore: complete Plan 06-02 - Emulator detection bypass"

## Files to Create/Modify

| File | Action | Purpose |
|------|--------|---------|
| `frida_emulator_bypass.js` | Create | Emulator detection bypass script |
| `README.md` | Modify | Add emulator bypass documentation |
| `.planning/phases/06-security-bypasses/06-02-SUMMARY.md` | Create | Execution summary |

## Verification

After execution:
1. `frida_emulator_bypass.js` exists with all documented hooks
2. README has complete Security Bypasses section with all scripts
3. Scripts table lists all Frida bypass scripts

## Notes

- Build field modification requires special Frida technique (fields vs methods)
- Some detection methods use native code which may require additional frida-server configuration
- This script is designed for Android emulators; physical device testing may need different values
- Combining with root bypass: `frida -U -l frida_root_bypass.js -l frida_emulator_bypass.js -f com.target.app`
