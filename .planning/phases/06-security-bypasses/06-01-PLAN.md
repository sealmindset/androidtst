# Plan: 06-01 Root Detection Bypass

## Context

**Phase**: 6 - Security Bypasses
**Goal**: Create a Frida script that bypasses common root detection mechanisms
**Dependencies**: Phase 2 (harness must be generalized)
**Patterns**: Follow existing Frida script structure (frida_ssl_bypass.js)

## Background

Root detection is commonly implemented by Android apps to prevent running on rooted devices. Apps typically check:

1. **Su binary existence** - Checks common paths like /system/xbin/su, /system/bin/su
2. **Root management apps** - Magisk Manager, SuperSU, KingRoot, etc.
3. **Build tags** - Build.TAGS contains "test-keys" on rooted devices
4. **RootBeer library** - Popular detection library with multiple checks
5. **Native checks** - Shell commands via Runtime.exec() to find su
6. **System properties** - ro.debuggable, ro.secure values
7. **Busybox** - Often installed on rooted devices

## Tasks

### Task 1: Create frida_root_bypass.js

Create the root detection bypass Frida script with hooks for common detection methods.

**File**: `frida_root_bypass.js`

**Hooks to implement**:
1. **File.exists()** - Return false for root-related paths (su, Superuser.apk, Magisk)
2. **Runtime.exec()** - Block commands checking for su/which su
3. **Build.TAGS** - Return "release-keys" instead of "test-keys"
4. **System.getProperty()** - Return safe values for ro.debuggable, ro.secure
5. **PackageManager.getPackageInfo()** - Hide root management apps
6. **ProcessBuilder** - Block root-checking processes

**Structure**:
```javascript
Java.perform(function() {
    console.log("[*] Starting Root Detection Bypass...");

    // Hook File.exists() for root paths
    // Hook Runtime.exec() for su commands
    // Hook Build.TAGS
    // Hook System.getProperty()
    // Hook PackageManager for root apps

    console.log("[*] Root Detection Bypass Complete!");
});
```

**Verification**:
- Script has valid JavaScript syntax
- All hooks wrapped in try-catch
- Logging follows existing pattern

**Commit**: "feat: add root detection bypass Frida script"

### Task 2: Update README with root bypass documentation

Add documentation for using the root bypass script.

**File**: `README.md`

**Changes**:
- Add "Security Bypasses" section after APK Analysis
- Document frida_root_bypass.js usage
- Add prerequisites (Frida installation)
- Add example command to run bypass
- Update Scripts Overview table

**Verification**:
- Security Bypasses section exists
- Root bypass documented with usage example
- Scripts table updated

**Commit**: "docs: add root detection bypass documentation"

### Task 3: Verify script structure and commit metadata

**Verification checklist**:
- [ ] frida_root_bypass.js exists and follows project patterns
- [ ] README.md includes root bypass documentation
- [ ] Script uses same patterns as frida_ssl_bypass.js

**Metadata**:
- Create 06-01-SUMMARY.md
- Update STATE.md with Phase 6 progress
- Update ROADMAP.md to mark 06-01 complete

**Commit**: "chore: complete Plan 06-01 - Root detection bypass"

## Files to Create/Modify

| File | Action | Purpose |
|------|--------|---------|
| `frida_root_bypass.js` | Create | Root detection bypass script |
| `README.md` | Modify | Add Security Bypasses section |
| `.planning/phases/06-security-bypasses/06-01-SUMMARY.md` | Create | Execution summary |

## Verification

After execution:
1. `frida_root_bypass.js` exists with all documented hooks
2. README has Security Bypasses section
3. Script follows same structure as existing Frida scripts

## Notes

- All hooks must be wrapped in try-catch to handle apps that don't use specific methods
- Logging should help identify which detection methods the target app uses
- This script is generic; app-specific bypasses may need additional hooks discovered through analysis
