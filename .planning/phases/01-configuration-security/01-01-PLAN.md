---
phase: 01-configuration-security
plan: 01
type: execute
---

<objective>
Create environment variable configuration system for the Python test harness.

Purpose: Eliminate hardcoded credentials by establishing a proper configuration management pattern that other harness components can use.
Output: A config module, .env template, and updated .gitignore to prevent credential exposure.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/codebase/CONCERNS.md
@.planning/codebase/STACK.md

**Current state:** `test_idor.py` has hardcoded credentials at lines 17-19:
```python
TEST_EMAIL = "ravance@gmail.com"
TEST_PASSWORD = "Test3214@"
YOUR_SLEEPER_ID = "-9223372019953519548"
```

**Stack note:** Python harness uses standard library only. Adding python-dotenv is acceptable as it's a minimal, well-established dependency.

**Pattern to follow:** The Playwright harness has `utils/config.ts` for configuration. Create similar pattern for Python harness.
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Python configuration module</name>
  <files>config.py</files>
  <action>
Create `config.py` in root directory that:
1. Uses `python-dotenv` to load from `.env` file
2. Defines configuration class/dataclass with typed fields:
   - `test_email: str`
   - `test_password: str`
   - `sleeper_id: str`
   - `api_base: str` (default: "https://api.sleepiq.sleepnumber.com/rest")
3. Provides clear error messages if required env vars are missing
4. Exports a `config` instance for use by other modules

Use dataclass for type hints and cleaner code. Include docstring explaining purpose.
Do NOT include any default values for credentials - they must come from environment.
  </action>
  <verify>python3 -c "from config import config; print('Config loaded')" shows error about missing env vars (expected)</verify>
  <done>config.py exists with typed configuration class, loads from .env, raises clear errors for missing required vars</done>
</task>

<task type="auto">
  <name>Task 2: Create .env template and update .gitignore</name>
  <files>.env.example, .gitignore</files>
  <action>
1. Create `.env.example` with placeholder values:
   ```
   # Android Test Harness Configuration
   # Copy to .env and fill in real values

   TEST_EMAIL=your-test-email@example.com
   TEST_PASSWORD=your-test-password
   SLEEPER_ID=your-sleeper-id

   # Optional - defaults provided
   # API_BASE=https://api.sleepiq.sleepnumber.com/rest
   ```

2. Update `.gitignore` (create if not exists) to include:
   - `.env` (credentials file)
   - `/tmp/` patterns should NOT be added (they're not in repo)
   - Keep existing entries if .gitignore exists

Do NOT create `.env` file - user must do that with their own credentials.
  </action>
  <verify>cat .env.example shows template; grep -q "^\.env$" .gitignore returns 0</verify>
  <done>.env.example exists with clear template, .gitignore prevents .env from being committed</done>
</task>

<task type="auto">
  <name>Task 3: Add python-dotenv to requirements</name>
  <files>requirements.txt</files>
  <action>
Create `requirements.txt` with:
```
# Android Test Harness Python Dependencies
python-dotenv>=1.0.0
```

This is the first external Python dependency. Keep it minimal.
  </action>
  <verify>cat requirements.txt shows python-dotenv</verify>
  <done>requirements.txt exists with python-dotenv dependency</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `python3 -c "from config import config"` imports without syntax errors (will fail on missing env vars - that's correct)
- [ ] `.env.example` exists with clear documentation
- [ ] `.gitignore` includes `.env`
- [ ] `requirements.txt` includes python-dotenv
- [ ] No actual credentials in any committed files
</verification>

<success_criteria>
- All tasks completed
- Configuration module ready for use by test_idor.py
- Clear template for users to create their own .env
- Credentials protected from accidental commit
</success_criteria>

<output>
After completion, create `.planning/phases/01-configuration-security/01-01-SUMMARY.md`
</output>
